"use strict";(self.webpackChunkjsvm2_docs=self.webpackChunkjsvm2_docs||[]).push([[6237],{1417:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>o,contentTitle:()=>d,default:()=>t,frontMatter:()=>c,metadata:()=>r,toc:()=>x});var l=i(6070),s=i(1249);const c={sidebar_position:3},d="Context API",r={id:"api/context",title:"Context API",description:"Context \u7c7b\u63d0\u4f9b\u4e86\u4ee3\u7801\u6267\u884c\u7684\u6c99\u7bb1\u73af\u5883\uff0c\u5305\u542b\u6240\u6709\u53ef\u8bbf\u95ee\u7684\u5168\u5c40\u5bf9\u8c61\u548c\u53d8\u91cf\u3002",source:"@site/docs/api/context.md",sourceDirName:"api",slug:"/api/context",permalink:"/jsvm2/docs/api/context",draft:!1,unlisted:!1,editUrl:"https://github.com/ximing/jsvm2/tree/master/docs/docs/api/context.md",tags:[],version:"current",sidebarPosition:3,frontMatter:{sidebar_position:3},sidebar:"tutorialSidebar",previous:{title:"VM API",permalink:"/jsvm2/docs/api/vm"},next:{title:"Scope API",permalink:"/jsvm2/docs/api/scope"}},o={},x=[{value:"Context \u7c7b",id:"context-\u7c7b",level:2},{value:"\u6784\u9020\u51fd\u6570\u53c2\u6570",id:"\u6784\u9020\u51fd\u6570\u53c2\u6570",level:3},{value:"\u9ed8\u8ba4\u5168\u5c40\u5bf9\u8c61",id:"\u9ed8\u8ba4\u5168\u5c40\u5bf9\u8c61",level:3},{value:"\u57fa\u672c\u503c",id:"\u57fa\u672c\u503c",level:4},{value:"\u5168\u5c40\u51fd\u6570",id:"\u5168\u5c40\u51fd\u6570",level:4},{value:"\u6784\u9020\u51fd\u6570",id:"\u6784\u9020\u51fd\u6570",level:4},{value:"\u9519\u8bef\u5bf9\u8c61",id:"\u9519\u8bef\u5bf9\u8c61",level:4},{value:"\u5b9e\u7528\u5bf9\u8c61",id:"\u5b9e\u7528\u5bf9\u8c61",level:4},{value:"\u73b0\u4ee3\u7279\u6027\u652f\u6301",id:"\u73b0\u4ee3\u7279\u6027\u652f\u6301",level:3},{value:"\u4f7f\u7528\u793a\u4f8b",id:"\u4f7f\u7528\u793a\u4f8b",level:3},{value:"\u5b89\u5168\u7279\u6027",id:"\u5b89\u5168\u7279\u6027",level:3},{value:"\u6027\u80fd\u4f18\u5316",id:"\u6027\u80fd\u4f18\u5316",level:3}];function h(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"context-api",children:"Context API"})}),"\n",(0,l.jsx)(n.p,{children:"Context \u7c7b\u63d0\u4f9b\u4e86\u4ee3\u7801\u6267\u884c\u7684\u6c99\u7bb1\u73af\u5883\uff0c\u5305\u542b\u6240\u6709\u53ef\u8bbf\u95ee\u7684\u5168\u5c40\u5bf9\u8c61\u548c\u53d8\u91cf\u3002"}),"\n",(0,l.jsx)(n.h2,{id:"context-\u7c7b",children:"Context \u7c7b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-typescript",children:"class Context {\n  constructor(externalContext: ISandBox = {})\n}\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u6784\u9020\u51fd\u6570\u53c2\u6570",children:"\u6784\u9020\u51fd\u6570\u53c2\u6570"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"externalContext"})," - \u5916\u90e8\u63d0\u4f9b\u7684\u6c99\u7bb1\u5bf9\u8c61"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u9ed8\u8ba4\u5168\u5c40\u5bf9\u8c61",children:"\u9ed8\u8ba4\u5168\u5c40\u5bf9\u8c61"}),"\n",(0,l.jsx)(n.p,{children:"Context \u5b9e\u4f8b\u9ed8\u8ba4\u5305\u542b\u4ee5\u4e0b\u6807\u51c6 ECMAScript \u5bf9\u8c61\uff1a"}),"\n",(0,l.jsx)(n.h4,{id:"\u57fa\u672c\u503c",children:"\u57fa\u672c\u503c"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Infinity"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"NaN"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"undefined"})}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u5168\u5c40\u51fd\u6570",children:"\u5168\u5c40\u51fd\u6570"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"isFinite()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"isNaN()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"parseFloat()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"parseInt()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"decodeURI()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"decodeURIComponent()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"encodeURI()"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"encodeURIComponent()"})}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u6784\u9020\u51fd\u6570",children:"\u6784\u9020\u51fd\u6570"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Object"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Function"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Boolean"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Number"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"String"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Array"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Date"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"RegExp"})}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u9519\u8bef\u5bf9\u8c61",children:"\u9519\u8bef\u5bf9\u8c61"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Error"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"EvalError"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"RangeError"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"ReferenceError"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"SyntaxError"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"TypeError"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"URIError"})}),"\n"]}),"\n",(0,l.jsx)(n.h4,{id:"\u5b9e\u7528\u5bf9\u8c61",children:"\u5b9e\u7528\u5bf9\u8c61"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Math"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"JSON"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"console"})}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u73b0\u4ee3\u7279\u6027\u652f\u6301",children:"\u73b0\u4ee3\u7279\u6027\u652f\u6301"}),"\n",(0,l.jsx)(n.p,{children:"\u5982\u679c\u5bbf\u4e3b\u73af\u5883\u652f\u6301\uff0c\u8fd8\u4f1a\u5305\u542b\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Symbol"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.code,{children:"Promise"})}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Map"})," / ",(0,l.jsx)(n.code,{children:"Set"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"WeakMap"})," / ",(0,l.jsx)(n.code,{children:"WeakSet"})]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.code,{children:"Proxy"})," / ",(0,l.jsx)(n.code,{children:"Reflect"})]}),"\n",(0,l.jsx)(n.li,{children:"\u5404\u79cd TypedArray"}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u4f7f\u7528\u793a\u4f8b",children:"\u4f7f\u7528\u793a\u4f8b"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-javascript",children:"import { createContext, runInContext } from 'jsvm2';\nimport { parse } from '@babel/parser';\n\n// \u521b\u5efa\u81ea\u5b9a\u4e49\u4e0a\u4e0b\u6587\nconst context = createContext({\n  // \u81ea\u5b9a\u4e49\u53d8\u91cf\n  appName: 'MyApp',\n  version: '1.0.0',\n\n  // \u81ea\u5b9a\u4e49\u51fd\u6570\n  log: (msg) => console.log('[App]', msg),\n\n  // \u53d7\u9650\u7684 Math \u5bf9\u8c61\n  Math: {\n    abs: Math.abs,\n    max: Math.max,\n    min: Math.min\n  }\n});\n\n// \u6267\u884c\u4ee3\u7801\nconst code = `\n  log('\u5e94\u7528\u542f\u52a8: ' + appName + ' v' + version);\n  Math.abs(-42);\n`;\n\nconst ast = parse(code);\nconst result = runInContext(ast, context);\n// \u8f93\u51fa: [App] \u5e94\u7528\u542f\u52a8: MyApp v1.0.0\nconsole.log(result); // 42\n"})}),"\n",(0,l.jsx)(n.h3,{id:"\u5b89\u5168\u7279\u6027",children:"\u5b89\u5168\u7279\u6027"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5b8c\u5168\u9694\u79bb"}),"\uff1a\u6c99\u7bb1\u4ee3\u7801\u65e0\u6cd5\u8bbf\u95ee\u5bbf\u4e3b\u73af\u5883\u7684\u5168\u5c40\u53d8\u91cf"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u539f\u578b\u4fdd\u62a4"}),"\uff1a\u65e0\u6cd5\u4fee\u6539\u5185\u7f6e\u5bf9\u8c61\u7684\u539f\u578b\u94fe"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u53d7\u63a7\u8bbf\u95ee"}),"\uff1a\u53ea\u80fd\u8bbf\u95ee\u663e\u5f0f\u63d0\u4f9b\u7684 API"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"\u6027\u80fd\u4f18\u5316",children:"\u6027\u80fd\u4f18\u5316"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u590d\u7528\u4e0a\u4e0b\u6587"}),"\uff1a\u907f\u514d\u9891\u7e41\u521b\u5efa\u65b0\u7684 Context \u5b9e\u4f8b"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6700\u5c0f\u5316\u6c99\u7bb1"}),"\uff1a\u53ea\u5305\u542b\u5fc5\u8981\u7684\u5168\u5c40\u5bf9\u8c61"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9884\u521b\u5efa\u5bf9\u8c61"}),"\uff1a\u5c06\u590d\u6742\u5bf9\u8c61\u9884\u5148\u521b\u5efa\u5e76\u653e\u5165\u4e0a\u4e0b\u6587"]}),"\n"]})]})}function t(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}}}]);